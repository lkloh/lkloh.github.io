<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Things I Should Know</title>
  <meta name="description" content="but somehow only just learnt">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://localhost:4000/page3/">
  <link rel="alternate" type="application/rss+xml" title="Things I Should Know" href="/feed.xml">
  
  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/">Things I Should Know</a>
  
    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
            <a class="page-link" href="/about/">About</a>
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <!-- This loops through the paginated posts -->

  <h1><a href="/2017/09/17/stop-event-propagation.html">JQuery: ev.stopPropagation()</a></h1>
  <p class="author">
    <span class="date">2017-09-17 00:00:00 -0700</span>
  </p>
  <div class="content">
    <p>You’re supposed to write</p>
<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">$</span><span class="p">(</span><span class="s1">'button'</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="nx">ev</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="nx">ev</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
	<span class="nx">doSomething</span><span class="p">();</span>
<span class="p">});</span>
</code></pre>
</div>

<p>instead of the more concise</p>
<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">$</span><span class="p">(</span><span class="s1">'button'</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="nx">ev</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="nx">doSomething</span><span class="p">();</span>
<span class="p">});</span>
</code></pre>
</div>

<p>That’s because if we have the html as</p>
<div class="highlighter-rouge"><pre class="highlight"><code>&lt;div id='outer'&gt;
	&lt;button &gt;&lt;/button&gt;
&lt;/div&gt;
</code></pre>
</div>

<p>and the jQuery script as</p>
<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">$</span><span class="p">(</span><span class="s1">'button'</span><span class="p">).</span><span class="nx">click</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="nx">alert</span><span class="p">(</span><span class="s1">'button'</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">$</span><span class="p">(</span><span class="s1">'div'</span><span class="p">).</span><span class="nx">click</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="nx">alert</span><span class="p">(</span><span class="s1">'div'</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
</div>

<p>Then when the button is clicked, the click action is also bubbled up to its parent div,
so two alerts, “button” and “div” would be fired.</p>

<p>To avoid this problem, the jQuery script should be</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">$</span><span class="p">(</span><span class="s1">'button'</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="nx">ev</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="nx">ev</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
	<span class="nx">alert</span><span class="p">(</span><span class="s1">'button'</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">$</span><span class="p">(</span><span class="s1">'div'</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="nx">ev</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="nx">ev</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
	<span class="nx">alert</span><span class="p">(</span><span class="s1">'div'</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
</div>

<p>w3schools has the best illustration of this 
<a href="https://www.w3schools.com/jquery/event_stoppropagation.asp">here</a>.</p>


  </div>

  <h1><a href="/2017/09/16/throwing-errors.html">Which network error should a server throw?</a></h1>
  <p class="author">
    <span class="date">2017-09-16 00:00:00 -0700</span>
  </p>
  <div class="content">
    <p>If the client send the server a problematic request, 
throw them a 4xx error
to tell them to fix it on their side.</p>

<p>The client sent a valid request,
but the server has some issues and can’t serve the client,
throw a 5xx error to tell the client to retry later.</p>

<p>Also explain what went wrong to the client.
Read more <a href="http://restcookbook.com/HTTP%20Methods/400-vs-500/">here</a>.</p>

  </div>

  <h1><a href="/2017/09/15/no-comment.html">No comment</a></h1>
  <p class="author">
    <span class="date">2017-09-15 00:00:00 -0700</span>
  </p>
  <div class="content">
    <p>Comments are supposed to be good.
At least, that what my <a href="http://web.stanford.edu/class/cs106a/">introductory computer science class’s</a>
lecturer said repeatedly.
In fact, we were docked points for bad style when we have no comments.</p>

<p>So naturally I freaked out and commented every. single. function. I wrote,
usually after I had finished the entire program,
so that I wouldn’t lose points.</p>

<p>Eventually I learnt to only write comments to 
explain what some code was doing in a function.
In the following example taken from <a href="https://github.com/django/django">here</a>, 
I would probably have written something like</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">'_body'</span><span class="p">):</span>
        <span class="c"># Ensure request has not been read yet</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_started</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RawPostDataException</span><span class="p">(</span><span class="s">"You cannot access body after reading from request's data stream"</span><span class="p">)</span>

        <span class="c"># Limit the maximum request data size that will be handled in-memory.</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">DATA_UPLOAD_MAX_MEMORY_SIZE</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span>
                <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'CONTENT_LENGTH'</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">settings</span><span class="o">.</span><span class="n">DATA_UPLOAD_MAX_MEMORY_SIZE</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">RequestDataTooBig</span><span class="p">(</span><span class="s">'Request body exceeded settings.DATA_UPLOAD_MAX_MEMORY_SIZE.'</span><span class="p">)</span>

        <span class="c"># Obtain body</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">except</span> <span class="nb">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">UnreadablePostError</span><span class="p">(</span><span class="o">*</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="k">from</span> <span class="n">e</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stream</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_body</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_body</span>
</code></pre>
</div>

<p>But that’s still no good, too much of implementation details,
and implementations change fairly often.
Either you’ll remember to change the comments after fixing the implementations,
or most likely you’ll forget it, and the comment will become wrong after a while.
I’ve done that more than once.
And obviously a wrong comment is worst than no comment because it just confuses
other people who read it.</p>

<p>Instead, its better to refactor the code until its self-explanatory.
No need to update comments, and the code base is kept as lean as possible.</p>

<p>Something like:</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">'_body'</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_started</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RawPostDataException</span><span class="p">(</span><span class="s">"You cannot access body after reading from request's data stream"</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">DATA_UPLOAD_MAX_MEMORY_SIZE</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span>
                <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">META</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'CONTENT_LENGTH'</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">settings</span><span class="o">.</span><span class="n">DATA_UPLOAD_MAX_MEMORY_SIZE</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">RequestDataTooBig</span><span class="p">(</span><span class="s">'Request body exceeded settings.DATA_UPLOAD_MAX_MEMORY_SIZE.'</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">except</span> <span class="nb">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">UnreadablePostError</span><span class="p">(</span><span class="o">*</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="k">from</span> <span class="n">e</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stream</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_body</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_body</span>
</code></pre>
</div>

<p>Obviously add comments if a particular implementation is really obscure,
and there’s no easy way to make it more obvious. 
Or if several other contributors demand you to add it in because they think its obsure.
But in general it’s best to err on the side of avoiding comments.</p>

<p>Now if only when in college,
I didn’t spend 2 hours after getting my code to compile, 
writing extra comments on code I was never going to reuse,
I would have gotten more sleep.</p>


  </div>

  <h1><a href="/2017/09/14/shorter-names.html">Shorter names in programs</a></h1>
  <p class="author">
    <span class="date">2017-09-14 00:00:00 -0700</span>
  </p>
  <div class="content">
    <p>Magic numbers are not good for maintainance. Clearly</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">sell</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">7</span><span class="p">:</span>
        <span class="n">n</span><span class="o">--</span><span class="p">;</span>
        <span class="n">sell_a_crate</span><span class="p">()</span>
</code></pre>
</div>
<p>doesn’t explain what <code class="highlighter-rouge">7</code> represents.</p>

<p>It would be better to do something like:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">num_crates_to_keep_for_personal_use</span> <span class="o">=</span> <span class="mi">7</span>

<span class="k">def</span> <span class="nf">sell_produce_we_will_not_use</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="n">num_crates_to_keep_for_personal_use</span><span class="p">:</span>
        <span class="n">n</span><span class="o">--</span><span class="p">;</span>
        <span class="n">sell_a_crate_of_extra_produce</span><span class="p">()</span>
</code></pre>
</div>
<p>for long term maintainence.</p>

<p>But that results in a different problem:
names that are too long decreate readability as well.
The human eye can only take in so much.
This <a href="https://stackoverflow.com/questions/1017624/when-is-a-function-name-too-long">StackOverflow</a> 
post has a long discussion, but in essense it boils down to:</p>

<ul>
  <li>Names should be &lt;= 40 characters, 
  more than that makes it hard to digest when looking
  at the function from a screen.</li>
  <li>Names should describe the what the function/variable is used for.</li>
  <li>If its not possible to fulfil the above two, you need to do some refactoring.</li>
</ul>

<p>So something like</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">n_crates_to_keep</span> <span class="o">=</span> <span class="mi">7</span>

<span class="k">def</span> <span class="nf">sell_excess_produce</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="n">n_crates_to_keep</span><span class="p">:</span>
        <span class="n">n</span><span class="o">--</span><span class="p">;</span>
        <span class="n">sell_crate</span><span class="p">()</span>
</code></pre>
</div>
<p>would be better.</p>


  </div>

  <h1><a href="/2017/09/13/cleaner-testing.html">Cleaner Testing</a></h1>
  <p class="author">
    <span class="date">2017-09-13 00:00:00 -0700</span>
  </p>
  <div class="content">
    <p>When there is a large suite of tests,
one should reuse the setup code</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Test</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">company_people</span> <span class="o">=</span> <span class="p">{</span>
        	<span class="s">'CEO'</span><span class="p">:</span> <span class="s">'alice'</span><span class="p">,</span>
			<span class="s">'COO'</span><span class="p">:</span> <span class="s">'bob'</span><span class="p">,</span>
			<span class="s">'Manager'</span><span class="p">:</span> <span class="s">'charlie'</span><span class="p">,</span>
			<span class="s">'Receptionist'</span><span class="p">:</span> <span class="s">'dave'</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">write_to_database</span><span class="p">(</span><span class="n">company_people</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_transform_names_to_capitalized</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    	<span class="n">expected_company_people</span> <span class="o">=</span> <span class="p">{</span>
        	<span class="s">'CEO'</span><span class="p">:</span> <span class="s">'Alice'</span><span class="p">,</span>
			<span class="s">'COO'</span><span class="p">:</span> <span class="s">'Bob'</span><span class="p">,</span>
			<span class="s">'Manager'</span><span class="p">:</span> <span class="s">'Charlie'</span><span class="p">,</span>
			<span class="s">'Receptionist'</span><span class="p">:</span> <span class="s">'Dave'</span><span class="p">,</span>
        <span class="p">}</span>
    	<span class="k">assert</span> <span class="n">transform_names_to_capitalized</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">company_people</span><span class="p">)</span> <span class="o">==</span> <span class="n">expected_company_people</span>

   	<span class="k">def</span> <span class="nf">test_update_cleaner</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
   		<span class="n">new_company_people</span> <span class="o">=</span> <span class="p">{</span>
        	<span class="s">'CEO'</span><span class="p">:</span> <span class="s">'Alice'</span><span class="p">,</span>
			<span class="s">'COO'</span><span class="p">:</span> <span class="s">'Bob'</span><span class="p">,</span>
			<span class="s">'Manager'</span><span class="p">:</span> <span class="s">'Charlie'</span><span class="p">,</span>
			<span class="s">'Receptionist'</span><span class="p">:</span> <span class="s">'Dave'</span><span class="p">,</span>
			<span class="s">'Cleaner'</span><span class="p">:</span> <span class="s">'Eve'</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">expected_company_people</span> <span class="o">=</span> <span class="p">{</span>
        	<span class="s">'CEO'</span><span class="p">:</span> <span class="s">'Alice'</span><span class="p">,</span>
			<span class="s">'COO'</span><span class="p">:</span> <span class="s">'Bob'</span><span class="p">,</span>
			<span class="s">'Manager'</span><span class="p">:</span> <span class="s">'Charlie'</span><span class="p">,</span>
			<span class="s">'Receptionist'</span><span class="p">:</span> <span class="s">'Dave'</span><span class="p">,</span>
			<span class="s">'Cleaner'</span><span class="p">:</span> <span class="s">'Flora'</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">assert</span> <span class="n">update_cleaner</span><span class="p">(</span><span class="s">'Flora'</span><span class="p">)</span> <span class="o">=</span> <span class="n">expected_company_people</span>
</code></pre>
</div>

<p>In this case, <code class="highlighter-rouge">test_add_cleaner</code> isn’t the best way to do things,
because it is copying a large test value again,
that already appears in the set up.</p>

<p>Instead it would be better to refactor it to:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_update_cleaner</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">company_people</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">'Cleaner'</span><span class="p">:</span> <span class="s">'Eve'</span><span class="p">})</span>
	<span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">company_people</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'Cleaner'</span><span class="p">)</span> <span class="o">==</span> <span class="s">'Eve'</span> 
    <span class="k">assert</span> <span class="n">add_cleaner</span><span class="p">(</span><span class="s">'Flora'</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'Cleaner'</span><span class="p">)</span> <span class="o">==</span> <span class="s">'Flora'</span>
</code></pre>
</div>

<p>The above function makes it clear that the cleaner
before and after <code class="highlighter-rouge">update_cleaner</code> was called is different.
This saves on amount of code, and also makes it easier to understand what the test
is trying to verify.</p>


  </div>

  <h1><a href="/2017/09/12/dotadiw.html">DOTADIW</a></h1>
  <p class="author">
    <span class="date">2017-09-12 00:00:00 -0700</span>
  </p>
  <div class="content">
    <p>Because the machine representaion of floats is not exact,
somethings you get something like this in Python:</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">+</span> <span class="mf">0.2</span> <span class="o">+</span> <span class="mf">0.30</span>
<span class="k">print</span> <span class="n">x</span>
</code></pre>
</div>
<p>and get <code class="highlighter-rouge">0.6000000000000001</code> as your output.</p>

<p>Or at least I got that in Python 2 on my laptop.</p>

<p>If you wanted to make sure that <code class="highlighter-rouge">x = 0.6</code> for some reason, then you may have a bit of trouble,
because <code class="highlighter-rouge">0.6000000000000001 != 0.6</code>.</p>

<p>To fix this, we could do something like this:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">check_for_equality</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
	<span class="s">'''
	values: list of floats, guaranteed to have at most one decimal place
	'''</span>
	<span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span> <span class="o">==</span> <span class="p">(</span><span class="mf">0.6</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
</code></pre>
</div>

<p>But this would only work properly for the particular use case in which 
there is at most one decimal place.</p>

<p>A better way to rewrite this in a way that can be used anywhere, repeatedly, is:</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">assert_near_equality</span><span class="p">(</span><span class="n">expected_value</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
	<span class="s">'''
	values: list of floats
	'''</span>
	<span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">-</span> <span class="n">expected_value</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">epsilon</span>
</code></pre>
</div>

<p>Now there are no restrictions imposed on <code class="highlighter-rouge">values</code></p>


  </div>

  <h1><a href="/2017/09/11/git-force-push.html">Git force push forces comments to disappear</a></h1>
  <p class="author">
    <span class="date">2017-09-11 00:00:00 -0700</span>
  </p>
  <div class="content">
    <p>I’ve used <code class="highlighter-rouge">git --force push</code> to forcefully push commits to master
after rebasing with other people’s changes.
Unfortunately this tends to make earlier comments disappear.
There are certainly <a href="https://stackoverflow.com/questions/3973994/how-can-i-recover-from-an-erronous-git-push-f-origin-master">ways to recover it</a>,
but its really troublesome to have to dig into it.
I think I’ll stick with saving comments I may want to go back and take a look by
taking a screenshot instead.</p>

  </div>

  <h1><a href="/2017/09/10/pure-functions.html">Pure functions</a></h1>
  <p class="author">
    <span class="date">2017-09-10 00:00:00 -0700</span>
  </p>
  <div class="content">
    <p><a href="https://www.sitepoint.com/functional-programming-pure-functions/">Pure functions</a>
have a return value determined only by its input values,
and not other states.</p>

<p>For example:</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">capitalize_dict__pure</span><span class="p">(</span><span class="n">dict_of_strings</span><span class="p">):</span>
	<span class="k">return</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">val</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">dict_of_strings</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s">'CEO'</span> <span class="k">else</span> <span class="n">val</span><span class="p">}</span>
</code></pre>
</div>
<p>is a pure function as the return value depends only on the dictionary passed in.</p>

<p>But</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">capitalize_dict__impure</span><span class="p">(</span><span class="n">dict_to_modify</span><span class="p">):</span>
	<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_to_modify</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s">'CEO'</span><span class="p">:</span>
			<span class="n">dict_to_modify</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
</code></pre>
</div>
<p>modifies one of the return value <code class="highlighter-rouge">dict_to_modify</code>,
and thus changes some data outside the function,
so is not pure.</p>

<p>It is good practice to use pure functions where possible,
as it is easier to test and maintain them.
One does not have to worry about side effects.</p>

<p>It is obvious how to test the first function:</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_empty_dict_returns_empty</span><span class="p">():</span>
	<span class="k">assert</span> <span class="n">capitalize_dict__pure</span><span class="p">({})</span> <span class="o">==</span> <span class="p">{}</span>

<span class="k">def</span> <span class="nf">test_ceo_is_not_changed</span><span class="p">():</span>
	<span class="n">company_people</span> <span class="o">=</span> <span class="p">{</span>
		<span class="s">'CEO'</span><span class="p">:</span> <span class="s">'alice'</span><span class="p">,</span>
		<span class="s">'COO'</span><span class="p">:</span> <span class="s">'bob'</span><span class="p">,</span>
		<span class="s">'Manager'</span><span class="p">:</span> <span class="s">'charlie'</span>
	<span class="p">}</span>
	<span class="k">assert</span> <span class="n">capitalize_dict__pure</span><span class="p">(</span><span class="n">company_people</span><span class="p">)</span> <span class="o">!=</span> <span class="n">company_people</span>
	<span class="n">expected_company_people</span> <span class="o">=</span> <span class="p">{</span>
		<span class="s">'CEO'</span><span class="p">:</span> <span class="s">'alice'</span><span class="p">,</span> 
		<span class="s">'COO'</span><span class="p">:</span> <span class="s">'Bob'</span><span class="p">,</span>
		<span class="s">'Manager'</span><span class="p">:</span> <span class="s">'Charlie'</span>
	<span class="p">}</span>
	<span class="k">assert</span> <span class="n">capitalize_dict__pure</span><span class="p">(</span><span class="n">company_people</span><span class="p">)</span> <span class="o">==</span> <span class="n">expected_company_people</span>
</code></pre>
</div>

<p>But the second function could exhibit different behavior depending on the functions that call it.
For example, if we have this function that we want to test instead, because it is hard
to test <code class="highlighter-rouge">capitalize_dict__impure</code> when it could change,
we may instead test the functions that call it:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_ceo_name</span><span class="p">(</span><span class="n">company_people</span><span class="p">):</span>
	<span class="n">capitalize_dict__impure</span><span class="p">(</span><span class="n">dict_to_modify</span><span class="p">)</span>
	<span class="n">company_people</span><span class="p">[</span><span class="s">'CEO'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'Alison'</span>
	<span class="k">return</span> <span class="n">company_people</span><span class="p">[</span><span class="s">'CEO'</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">get_ceo_name_formatted</span><span class="p">(</span><span class="n">company_people</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">capitalize_dict__impure</span><span class="p">(</span><span class="n">company_people</span><span class="p">)[</span><span class="s">'CEO'</span><span class="p">]</span>
</code></pre>
</div>

<p>Then we need separate tests for both the parent functions of <code class="highlighter-rouge">capitalize_dict__impure</code>.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_ceo_name</span><span class="p">():</span>
	<span class="n">company_people</span> <span class="o">=</span> <span class="p">{</span>
		<span class="s">'CEO'</span><span class="p">:</span> <span class="s">'alice'</span><span class="p">,</span>
		<span class="s">'COO'</span><span class="p">:</span> <span class="s">'bob'</span><span class="p">,</span>
		<span class="s">'Manager'</span><span class="p">:</span> <span class="s">'charlie'</span>
	<span class="p">}</span>
	<span class="k">assert</span> <span class="n">get_ceo_name</span><span class="p">(</span><span class="n">company_people</span><span class="p">)</span> <span class="o">==</span> <span class="s">'Alice'</span> <span class="o">//</span> <span class="n">fails</span>

<span class="k">def</span> <span class="nf">get_ceo_name_formatted</span><span class="p">():</span>
	<span class="n">company_people</span> <span class="o">=</span> <span class="p">{</span>
		<span class="s">'CEO'</span><span class="p">:</span> <span class="s">'alice'</span><span class="p">,</span>
		<span class="s">'COO'</span><span class="p">:</span> <span class="s">'bob'</span><span class="p">,</span>
		<span class="s">'Manager'</span><span class="p">:</span> <span class="s">'charlie'</span>
	<span class="p">}</span>
	<span class="k">assert</span> <span class="n">get_ceo_name</span><span class="p">(</span><span class="n">company_people</span><span class="p">)</span> <span class="o">==</span> <span class="s">'Alice'</span> <span class="o">//</span> <span class="n">correct</span>
</code></pre>
</div>

<p>And it is easier to get unexpected behavior that requires
more digging to fix.</p>


  </div>

  <h1><a href="/2017/09/09/think-before-you-buy.html">Think before you buy</a></h1>
  <p class="author">
    <span class="date">2017-09-09 00:00:00 -0700</span>
  </p>
  <div class="content">
    <p>Since moving from Singapore to the United States seven years ago,
I’ve had to move around a lot,
mostly on my own with no help.</p>

<p>The biggest thing moving around has taught me,
is to only buy something you’ll definitely use repeatedly, starting this week.
Not next month, not next year, not next season,
not when you lose weight or gain weight. Right now.
Anything that you won’t use right now will probably never get used,
and get thrown out several months or years from now.</p>

<p>I learnt that the hard way.
My parents came with me to set me up for freshman year of college,
and of course they wanted to buy everything they thought I might need.
We came over their three huge bags, and bought even more stuff
that my mother insisted was useful.
Over several years of occasional visits, my parents helped me acquire:
Hair dryer, ironing board, iron , printer, 
clothes hangers (thrown away after I decided to only buy wrinkle-free clothes),
simple black high heel shoes 
(worn them about 5 times in 7 years), 
several pairs of jeans 
(thrown away because they were too tight after gaining the Freshman Fifteen),
dress shirt and pants 
(thrown away because they were too loose after losing the Freshman Fifteen), 
extra bottles of shampoo so I wouldn’t need to run to the store so often without a car.</p>

<p>Honestly, they were quite reasonable compared to some other parents.
One of my friend’s parents bought them a mini-fridge for their dorm room
that they never used,
and I had a friend in grad school whose mother
bought her at least 20 pairs of shoes,
and a giant wardrobe as well.
It caused her a huge pain when she moved.</p>

<p>Even then, I had 10 boxes of stuff at the end of freshman year.
It was a real pain to arrange for storage and move everything again.
Repeat several more times for each year of college,
the first year after graduating,
the move to grad school in a new state,
then the move back to California after grad school…
I learnt very quickly only to buy things I would definitely use very often. 
Anything else could be borrowed.
And to buy furniture that I wouldn’t mind throwing away after one year
(a.k.a stuff that wasn’t too expensive).</p>

<p>By the time I moved from Pennsylvania back to California for a new position
after finishing grad school,
I brought only two suitcases with me – the same two suitcases
I had brought with me seven years ago during my initial move to college.
Since I had booked temporary housing in Berkeley for six weeks
to give me time to search for somewhere I could sign a lease on
in San Francisco, I would have to move again in California.
To minimize the amount of effort required to move, 
I sold my furniture in Pittsburgh for next to nothing,
and gave Goodwill two enormous bags full of rarely worn clothes.</p>

<p>Looking back, its kind of scary how much stuff I manage to accumulate every few months,
even with me consciously thinking before buying anything.
I was so careful about only buying stuff I would use multiple times,
that I slept on a pile of clothes for 10 days after moving to a new apartment 
while waiting for my mattress to arrive,
so I could avoid getting a sleeping bag that would contribute to clutter.
Maybe I’m taking my minimalist ways to the extreme.</p>

<p>On the other side of the spectrum,
my mother has kept our Enid Blyton storybooks for over twenty years,
awaiting the day my sister or I decide to procreate.
Perhaps I’ll sneak them to a used books store the next time I visit.</p>

  </div>

  <h1><a href="/2017/09/03/python-dict-library.html">Accessing dictionary values in Python</a></h1>
  <p class="author">
    <span class="date">2017-09-03 00:00:00 -0700</span>
  </p>
  <div class="content">
    <p>The last post was about dictionaries in Javascript.
This one will be about dictionaries in Python.</p>

<p>Given a dictionary that of form:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">alice_user_profile</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">'first_name'</span><span class="p">:</span> <span class="s">'Alice'</span><span class="p">,</span>
	<span class="s">'last_name'</span><span class="p">:</span> <span class="s">'Anderson'</span><span class="p">,</span>
	<span class="s">'age'</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
	<span class="s">'gender'</span><span class="p">:</span> <span class="s">'female'</span><span class="p">,</span>
	<span class="s">'owns_a_house: True,</span><span class="err">
</span><span class="s">}</span><span class="err">
</span></code></pre>
</div>

<p>You have to access dictionary values using bracket notation: 
<code class="highlighter-rouge">user_profile['first_name'] = 'Alice</code>.
Dot notation is not enabled for dictionaries, so
<code class="highlighter-rouge">user_profile.first_name</code> throws an error.</p>

<p>If we wanted to write a function that only does something if an attribute is present:
for example, if these profiles are all possible:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">alice_user_profile</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">'first_name'</span><span class="p">:</span> <span class="s">'Alice'</span><span class="p">,</span>
	<span class="s">'last_name'</span><span class="p">:</span> <span class="s">'Anderson'</span><span class="p">,</span>
	<span class="s">'age'</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
	<span class="s">'gender'</span><span class="p">:</span> <span class="s">'female'</span><span class="p">,</span>
	<span class="s">'owns_a_house: True,</span><span class="err">
</span><span class="s">}</span><span class="err">

</span><span class="s">bob_user_profile = {</span><span class="err">
</span><span class="s">	'</span><span class="n">first_name</span><span class="s">': '</span><span class="n">Bob</span><span class="s">',</span><span class="err">
</span><span class="s">	'</span><span class="n">last_name</span><span class="s">': '</span><span class="n">Brown</span><span class="s">',</span><span class="err">
</span><span class="s">	'</span><span class="n">age</span><span class="s">': 21,</span><span class="err">
</span><span class="s">	'</span><span class="n">gender</span><span class="s">': '</span><span class="n">male</span><span class="s">',</span><span class="err">
</span><span class="s">}</span><span class="err">

</span><span class="s">charlie_user_profile = {</span><span class="err">
</span><span class="s">	'</span><span class="n">first_name</span><span class="s">': '</span><span class="n">Charlie</span><span class="s">',</span><span class="err">
</span><span class="s">	'</span><span class="n">last_name</span><span class="s">': '</span><span class="n">Chaplin</span><span class="s">',</span><span class="err">
</span><span class="s">	'</span><span class="n">age</span><span class="s">': 35,</span><span class="err">
</span><span class="s">	'</span><span class="n">gender</span><span class="s">': '</span><span class="n">male</span><span class="s">',</span><span class="err">
</span><span class="s">	'</span><span class="n">owns_a_house</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
<span class="p">}</span>
</code></pre>
</div>

<p>and we only want to send an advertisement for homeowner’s insurance to people
who own a house, we could do something like this</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">send_advertisement_to_select_people</span><span class="p">(</span><span class="n">user_profile</span><span class="p">):</span>
	<span class="k">if</span> <span class="p">(</span><span class="s">'college'</span> <span class="ow">in</span> <span class="n">user_profile</span><span class="p">)</span> <span class="ow">and</span> <span class="n">user_profile</span><span class="p">[</span><span class="s">'college'</span><span class="p">]:</span>
		<span class="n">send_homeowner_ad</span><span class="p">(</span><span class="n">user_profile</span><span class="p">)</span>
</code></pre>
</div>

<p>but it would be more concise to do this:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">send_advertisement_to_select_people</span><span class="p">(</span><span class="n">user_profile</span><span class="p">):</span>
	<span class="k">if</span> <span class="n">user_profile</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'owns_a_house'</span><span class="p">):</span>
		<span class="n">send_homeowner_ad</span><span class="p">(</span><span class="n">user_profile</span><span class="p">)</span>
</code></pre>
</div>

<p>since the <code class="highlighter-rouge">.get</code> function will return <code class="highlighter-rouge">True</code> if the user owns a house,
and <code class="highlighter-rouge">False</code> if he does not, or the attribute <code class="highlighter-rouge">owns_a_house</code> is not set.</p>

<p>Good reason to <a href="https://www.tutorialspoint.com/python/python_dictionary.htm">read the docs</a> 
more carefully.</p>


  </div>


<!-- Pagination links -->
<div class="pagination">
  
    <a href="/page2/" class="previous">Previous</a>
  
  <span class="page_number ">Page: 3 of 9</span>
  
    <a href="/page4/" class="next">Next</a>
  
</div>
      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Things I Should Know</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              LK Loh
            
            </li>
            
            <li><a href="mailto:lkloh2410@gmail.com">lkloh2410@gmail.com</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/lkloh"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">lkloh</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/lkloh1024"><span class="icon icon--twitter"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">lkloh1024</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>but somehow only just learnt</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
